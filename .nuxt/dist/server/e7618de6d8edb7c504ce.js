exports.ids=[28],exports.modules={112:function(t,e,n){"use strict";var o=n(26);e.a={async beforeMount(){if(this.$store.state.logging){const t=this.$watch("$store.state.logging",()=>{this.$store.state.isAuth?(this.$channel.$fire("user-signed"),t()):(this.$cookie.remove("JWT-TOKEN"),this.$channel.$fire("user-not-sign"))})}else{const t=Object(o.a)();this.$store.commit("SET_USER_TOKEN",t),await this.$store.dispatch("initAuth")?(this.$channel.$fire("user-signed"),this.$store.dispatch("getUserRoles")):(this.$cookie.remove("JWT-TOKEN"),this.$channel.$fire("user-not-sign"))}}}},147:function(t,e){t.exports={undefined:void 0}},148:function(t,e){t.exports={undefined:void 0}},149:function(t,e){t.exports={undefined:void 0}},254:function(t,e,n){"use strict";n.r(e);var o=n(147),r=n.n(o);for(var h in o)"default"!==h&&function(t){n.d(e,t,(function(){return o[t]}))}(h);e.default=r.a},255:function(t,e){t.exports={undefined:void 0}},256:function(t,e,n){"use strict";n.r(e);var o=n(148),r=n.n(o);for(var h in o)"default"!==h&&function(t){n.d(e,t,(function(){return o[t]}))}(h);e.default=r.a},257:function(t,e,n){"use strict";n.r(e);var o=n(149),r=n.n(o);for(var h in o)"default"!==h&&function(t){n.d(e,t,(function(){return o[t]}))}(h);e.default=r.a},350:function(t,e,n){"use strict";n.r(e);var o=n(112),r={name:"MenuBar",props:{show:{required:!0,type:Boolean},x:{required:!0,type:Number},y:{required:!0,type:Number}},data:()=>({items:[1,2,3,4,5]}),computed:{style(){return{transform:`translate3d(${this.x}px, ${this.y}px, 0)`}}},methods:{closeMenu(){this.$emit("close")}}},h=n(1);var c=Object(h.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"menu-bar__wrap"},[t._ssrNode('<div class="menu-bar__mask"'+t._ssrStyle(null,null,{display:t.show?"":"none"})+"></div> "),n("transition-group",{staticClass:"menu-bar",style:t.style,attrs:{name:"menu",tag:"div"}},t._l(t.items,(function(e){return n("div",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"show"}],key:e,staticClass:"menu-bar__item",on:{click:function(t){t.stopPropagation()}}})})),0)],2)}),[],!1,(function(t){var e=n(254);e.__inject__&&e.__inject__(t)}),null,"5e77f1da").exports,d=n(2),l={name:"FloatMenu",components:{MenuBar:c},data:()=>({leftDown:!1,rightDown:!1,noTouch:!0,beginX:-1,beginY:-1,openMenu:!1}),beforeMount(){this.blockRightClick(),Object(d.isTouchDevice)()?this.bindTouch():this.bindPC()},methods:{blockRightClick(){document.addEventListener("contextmenu",t=>t.preventDefault())},bindTouch(){document.addEventListener("touchstart",t=>{this.openMenu||t.touches.length>1&&(this.leftDown=!0,this.rightDown=!0)}),document.addEventListener("touchend",()=>{this.openMenu||(this.leftDown=!1,this.rightDown=!1,this.noTouch=!0)}),document.addEventListener("touchmove",t=>{if(this.rightDown&&this.leftDown&&!this.openMenu)if(this.noTouch)this.noTouch=!1,this.beginX=t.touches[0].clientX,this.beginY=t.touches[0].clientY;else{const e=this.beginX-t.touches[0].clientX,n=this.beginY-t.touches[0].clientY;n<-100&&Math.abs(e)<Math.abs(n)&&(this.openMenu=!0)}})},bindPC(){document.addEventListener("mousedown",t=>{this.openMenu||(0!==t.button||this.rightDown||(this.leftDown=!0),2===t.button&&this.leftDown&&(this.rightDown=!0))}),document.addEventListener("mouseup",t=>{this.openMenu||(0===t.button&&(this.leftDown=!1),2===t.button&&(this.rightDown=!1),this.noTouch=!0)}),document.addEventListener("mousemove",t=>{if(this.rightDown&&this.leftDown&&!this.openMenu)if(this.noTouch)this.noTouch=!1,this.beginX=t.clientX,this.beginY=t.clientY;else{const e=this.beginX-t.clientX,n=this.beginY-t.clientY;n<-100&&Math.abs(e)<Math.abs(n)&&(this.openMenu=!0)}})},handleClose(){this.openMenu=!1,this.leftDown=!1,this.rightDown=!1,this.noTouch=!0}}},menu=Object(h.a)(l,(function(){var t=this.$createElement;return(this._self._c||t)("MenuBar",{attrs:{show:this.openMenu,x:this.beginX,y:this.beginY},on:{close:this.handleClose}})}),[],!1,null,null,"7d6c6252").exports,f=(n(255),{name:"VTest",components:{},props:{color:{type:String,required:!0}},data:()=>({}),computed:{},watch:{},created(){},mounted(){},methods:{}});var m={name:"PwaLayout",layout:"empty",components:{Curtain:{name:"Curtain",props:{id:{required:!0,type:String},position:{type:Object,default:null}},data:()=>({canRender:!1,moving:!1,drag:!1,rect:{top:0,left:0,zIndex:0},startX:0,startY:0,startLeft:0,startTop:0}),computed:{wrapStyle(){const{rect:rect}=this;return{transform:`translate3d(${rect.left}px, ${rect.top}px, 0)`,zIndex:rect.zIndex}}},mounted(){this.initManager(),this.canRender=!0},beforeDestroy(){this.$manager.unbindComponent(this.id)},methods:{initManager(){if(!this.$manager.componentIsUnique(this.id))return void console.error(`curtain 组件的 id 必须是独一无二的，id：${this.id}已被注册`);const rect=this.$el.getBoundingClientRect();this.$manager.bindComponent(this.id,this),this.rect=this.$manager.getRect(this.id,this.position?{...this.position,width:rect.width,height:rect.height}:null)},handleStart(t){this.moving=!0,this.startX=t.clientX,this.startY=t.clientY,this.startLeft=this.rect.left,this.startTop=this.rect.top,this.updateIndex()},handleMove(t){this.moving&&(this.drag=!0,this.rect.left=this.startLeft+t.clientX-this.startX,this.rect.top=this.startTop+t.clientY-this.startY)},handleEnd(){this.drag=!1,this.moving=!1;const rect=this.$el.getBoundingClientRect();this.$manager.setRect(this.id,{top:rect.top,left:rect.left,width:rect.width,height:rect.height,zIndex:this.rect.zIndex})},handleClick(){this.updateIndex()},updateIndex(){this.rect.zIndex=this.$manager.setMaxIndex(this.id)}},render(t){return this.canRender?t("div",{class:["curtain",{"curtain--moving":this.drag}],style:this.wrapStyle,on:{click:this.handleClick}},[t("div",{class:"curtain__header"},[t("div",{class:"curtain__header__menu",attrs:{"data-id":this.id}})]),t("div",{class:"curtain__body"},this.$slots.default)]):t("div",{class:["curtain__placeholder"]},this.$slots.placeholder||this.placeholder)}},FloatMenu:menu,VTest:Object(h.a)(f,(function(){var t=this.$createElement;return(this._self._c||t)("div",{staticClass:"v-test",style:{backgroundColor:this.color}},[])}),[],!1,(function(t){var e=n(256);e.__inject__&&e.__inject__(t)}),null,"09e564e2").exports},mixins:[o.a]};var v=Object(h.a)(m,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"pwa"}},[this._ssrNode('<div class="view">',"</div>",[e("Curtain",{attrs:{id:"test"}},[e("VTest",{attrs:{color:"yellowgreen"}})],1),this._ssrNode(" "),e("Curtain",{attrs:{id:"test-2"}},[e("VTest",{attrs:{color:"lightpink"}})],1)],2),this._ssrNode(" "),e("FloatMenu",{staticClass:"float-menu"})],2)}),[],!1,(function(t){var e=n(257);e.__inject__&&e.__inject__(t)}),null,"645e1289");e.default=v.exports}};