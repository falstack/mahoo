exports.ids=[2],exports.modules={38:function(t,e){t.exports={undefined:void 0}},39:function(t,e){t.exports={undefined:void 0}},40:function(t,e,n){"use strict";var o=n(13);e.a={async beforeMount(){if(this.$store.state.logging){const t=this.$watch("$store.state.logging",()=>{this.$store.state.isAuth?(this.$channel.$fire("user-signed"),t()):(this.$cookie.remove("JWT-TOKEN"),this.$channel.$fire("user-not-sign"))})}else{const t=Object(o.a)();this.$store.commit("SET_USER_TOKEN",t),await this.$store.dispatch("initAuth")?(this.$channel.$fire("user-signed"),this.$store.dispatch("getUserRoles")):(this.$cookie.remove("JWT-TOKEN"),this.$channel.$fire("user-not-sign"))}}}},41:function(t,e){t.exports={undefined:void 0}},42:function(t,e){t.exports={undefined:void 0}},43:function(t,e){t.exports={undefined:void 0}},44:function(t,e){t.exports={undefined:void 0}},45:function(t,e){t.exports={undefined:void 0}},52:function(t,e,n){"use strict";n.r(e);var o=n(41),r=n.n(o);for(var h in o)"default"!==h&&function(t){n.d(e,t,(function(){return o[t]}))}(h);e.default=r.a},53:function(t,e){t.exports={undefined:void 0}},54:function(t,e){t.exports={undefined:void 0}},55:function(t,e,n){"use strict";n.r(e);var o=n(42),r=n.n(o);for(var h in o)"default"!==h&&function(t){n.d(e,t,(function(){return o[t]}))}(h);e.default=r.a},56:function(t,e,n){"use strict";n.r(e);var o=n(43),r=n.n(o);for(var h in o)"default"!==h&&function(t){n.d(e,t,(function(){return o[t]}))}(h);e.default=r.a},57:function(t,e,n){"use strict";n.r(e);var o=n(44),r=n.n(o);for(var h in o)"default"!==h&&function(t){n.d(e,t,(function(){return o[t]}))}(h);e.default=r.a},58:function(t,e,n){"use strict";n.r(e);var o=n(45),r=n.n(o);for(var h in o)"default"!==h&&function(t){n.d(e,t,(function(){return o[t]}))}(h);e.default=r.a},65:function(t,e,n){"use strict";n.r(e);var o=n(40),r={name:"MenuBar",props:{show:{required:!0,type:Boolean},x:{required:!0,type:Number},y:{required:!0,type:Number}},data:()=>({items:["还","在","研","发","中"]}),computed:{style(){return{transform:`translate3d(${this.x}px, ${this.y}px, 0)`}}},methods:{closeMenu(){this.$emit("close")}}},h=n(5);var c=Object(h.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"menu-bar__wrap"},[t._ssrNode('<div class="menu-bar__mask"'+t._ssrStyle(null,null,{display:t.show?"":"none"})+"></div> "),n("transition-group",{staticClass:"menu-bar",style:t.style,attrs:{name:"menu",tag:"div"}},t._l(t.items,(function(e){return n("div",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"show"}],key:e,staticClass:"menu-bar__item",domProps:{textContent:t._s(e)},on:{click:function(t){t.stopPropagation()}}})})),0)],2)}),[],!1,(function(t){var e=n(52);e.__inject__&&e.__inject__(t)}),null,"5e77f1da").exports,d=n(1),l={name:"FloatMenu",components:{MenuBar:c},data:()=>({leftDown:!1,rightDown:!1,noTouch:!0,beginX:-1,beginY:-1,openMenu:!1}),beforeMount(){this.blockRightClick(),Object(d.isTouchDevice)()?this.bindTouch():this.bindPC()},methods:{blockRightClick(){document.addEventListener("contextmenu",t=>t.preventDefault())},bindTouch(){document.addEventListener("touchstart",t=>{this.openMenu||t.touches.length>1&&(this.leftDown=!0,this.rightDown=!0)}),document.addEventListener("touchend",()=>{this.openMenu||(this.leftDown=!1,this.rightDown=!1,this.noTouch=!0)}),document.addEventListener("touchmove",t=>{if(this.rightDown&&this.leftDown&&!this.openMenu)if(this.noTouch)this.noTouch=!1,this.beginX=t.touches[0].clientX,this.beginY=t.touches[0].clientY;else{const e=this.beginX-t.touches[0].clientX,n=this.beginY-t.touches[0].clientY;n<-100&&Math.abs(e)<Math.abs(n)&&(this.openMenu=!0)}})},bindPC(){document.addEventListener("mousedown",t=>{this.openMenu||(0!==t.button||this.rightDown||(this.leftDown=!0),2===t.button&&this.leftDown&&(this.rightDown=!0))}),document.addEventListener("mouseup",t=>{this.openMenu||(0===t.button&&(this.leftDown=!1),2===t.button&&(this.rightDown=!1),this.noTouch=!0)}),document.addEventListener("mousemove",t=>{if(this.rightDown&&this.leftDown&&!this.openMenu)if(this.noTouch)this.noTouch=!1,this.beginX=t.clientX,this.beginY=t.clientY;else{const e=this.beginX-t.clientX,n=this.beginY-t.clientY;n<-100&&Math.abs(e)<Math.abs(n)&&(this.openMenu=!0)}})},handleClose(){this.openMenu=!1,this.leftDown=!1,this.rightDown=!1,this.noTouch=!0}}},menu=Object(h.a)(l,(function(){var t=this.$createElement;return(this._self._c||t)("MenuBar",{attrs:{show:this.openMenu,x:this.beginX,y:this.beginY},on:{close:this.handleClose}})}),[],!1,null,null,"7d6c6252").exports,f=(n(53),{name:"Curtain",props:{id:{required:!0,type:String},position:{type:Object,default:null}},data:()=>({canRender:!1,moving:!1,drag:!1,rect:{top:0,left:0,zIndex:0},startX:0,startY:0,startLeft:0,startTop:0}),computed:{wrapStyle(){const{rect:rect}=this;return{transform:`translate3d(${rect.left}px, ${rect.top}px, 0)`,zIndex:rect.zIndex}}},mounted(){this.initManager(),this.canRender=!0},beforeDestroy(){this.$manager.unbindComponent(this.id)},methods:{initManager(){if(!this.$manager.componentIsUnique(this.id))return void console.error(`curtain 组件的 id 必须是独一无二的，id：${this.id}已被注册`);const rect=this.$el.getBoundingClientRect();this.$manager.bindComponent(this.id,this),this.rect=this.$manager.getRect(this.id,this.position?{...this.position,width:rect.width,height:rect.height}:null)},handleStart(t){this.moving=!0,this.startX=t.clientX,this.startY=t.clientY,this.startLeft=this.rect.left,this.startTop=this.rect.top,this.updateIndex()},handleMove(t){this.moving&&(this.drag=!0,this.rect.left=this.startLeft+t.clientX-this.startX,this.rect.top=this.startTop+t.clientY-this.startY)},handleEnd(){this.drag=!1,this.moving=!1;const rect=this.$el.getBoundingClientRect();this.$manager.setRect(this.id,{top:rect.top,left:rect.left,width:rect.width,height:rect.height,zIndex:this.rect.zIndex})},handleClick(){this.updateIndex()},updateIndex(){this.rect.zIndex=this.$manager.setMaxIndex(this.id)}},render(t){return this.canRender?t("div",{class:["curtain",{"curtain--moving":this.drag}],style:this.wrapStyle,on:{click:this.handleClick}},[t("div",{class:"curtain__header"},[t("div",{class:"curtain__header__drag",attrs:{"data-id":this.id}})]),t("div",{class:"curtain__body"},this.$slots.default)]):t("div",{class:["curtain__placeholder"]},this.$slots.placeholder||this.placeholder)}}),m=(n(54),n(38),n(36)),v={name:"QrCode",components:{VSwitcher:n.n(m).a},props:{},data:()=>({}),computed:{},watch:{},created(){},mounted(){},methods:{}};var _=Object(h.a)(v,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"qr-wrap"},[e("VSwitcher",{attrs:{headers:["QQ","微信"],align:"center"}},[e("template",{slot:"0"},[e("img",{attrs:{src:"https://m1.calibur.tv/qq_mini_app.png",alt:""}}),this._v(" "),e("p",[this._v("使用手机QQ扫码访问")])]),this._v(" "),e("template",{slot:"1"},[e("img",{attrs:{src:"https://m1.calibur.tv/weixin_mini_app.jpg",alt:""}}),this._v(" "),e("p",[this._v("使用手机微信扫码访问")])])],2)],1)}),[],!1,(function(t){var e=n(55);e.__inject__&&e.__inject__(t)}),null,"adc8c804").exports,w={name:"Logo"};var $=Object(h.a)(w,(function(){var t=this.$createElement;return(this._self._c||t)("div",{staticClass:"logo"},[this._ssrNode('<img src="https://m1.calibur.tv/icon.png-sharejpg200" alt="logo"> <p>calibur.tv</p>')])}),[],!1,(function(t){var e=n(56);e.__inject__&&e.__inject__(t)}),null,"71cc9d0a").exports,x=(n(39),n(33)),C=n.n(x),M=n(2),y={name:"Create",components:{VButton:C.a},computed:{isAuth(){return this.$store.state.isAuth}},methods:{handleSignIn(){if(this.isAuth)return Object(M.e)(this),this.$cookie.remove("JWT-TOKEN"),this.$channel.socketDisconnect(),void(window.location="/");this.$channel.$emit("sign-in")},handleCreate(){this.$toast.success("先去小程序吧，网页之后我再维护~呐，好吗？")}}};var j={name:"PwaLayout",layout:"empty",components:{Logo:$,QrCode:_,Create:Object(h.a)(y,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"create"},[e("VButton",{attrs:{plain:""},on:{click:this.handleSignIn}},[this._v("\n    "+this._s(this.isAuth?"退出":"登录")+"\n  ")]),this._ssrNode(" "),e("VButton",{on:{click:this.handleCreate}},[this._v("投稿")])],2)}),[],!1,(function(t){var e=n(57);e.__inject__&&e.__inject__(t)}),null,"4fb5ae4c").exports,Curtain:f,FloatMenu:menu},mixins:[o.a],mounted(){n.e(3).then(n.t.bind(null,64,7))},methods:{handleClick(){}}};var D=Object(h.a)(j,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"desktop"}},[this._ssrNode('<canvas id="canvas"></canvas> '),this._ssrNode('<div class="view">',"</div>",[e("Curtain",{attrs:{id:"logo",position:{left:15,top:40}}},[e("Logo")],1),this._ssrNode(" "),e("Curtain",{attrs:{id:"qr-code",position:{left:255,top:40}}},[e("QrCode")],1),this._ssrNode(" "),e("Curtain",{attrs:{id:"create",position:{left:820,top:40}}},[e("Create")],1)],2),this._ssrNode(' <p class="beian"><a href="http://www.beian.miit.gov.cn/" target="_blank">互联网 ICP 备案：沪 ICP 备 17050785 号 - 1</a></p> '),e("FloatMenu",{staticClass:"float-menu"})],2)}),[],!1,(function(t){var e=n(58);e.__inject__&&e.__inject__(t)}),null,"0454551e");e.default=D.exports}};