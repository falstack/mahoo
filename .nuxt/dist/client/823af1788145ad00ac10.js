(window.webpackJsonp=window.webpackJsonp||[]).push([[37],{396:function(t,e,n){"use strict";n(30);var o,r=n(2),c=n(83);e.a={beforeMount:(o=Object(r.a)(regeneratorRuntime.mark((function t(){var e,n,o=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.$store.state.logging){t.next=4;break}e=this.$watch("$store.state.logging",(function(){o.$store.state.isAuth?(o.$channel.$fire("user-signed"),e()):(o.$cookie.remove("JWT-TOKEN"),o.$channel.$fire("user-not-sign"))})),t.next=10;break;case 4:return n=Object(c.a)(),this.$store.commit("SET_USER_TOKEN",n),t.next=8,this.$store.dispatch("initAuth");case 8:t.sent?(this.$channel.$fire("user-signed"),this.$store.dispatch("getUserRoles")):(this.$cookie.remove("JWT-TOKEN"),this.$channel.$fire("user-not-sign"));case 10:case"end":return t.stop()}}),t,this)}))),function(){return o.apply(this,arguments)})}},418:function(t,e,n){},419:function(t,e,n){},420:function(t,e,n){},547:function(t,e,n){"use strict";var o=n(418);n.n(o).a},548:function(t,e,n){},549:function(t,e,n){"use strict";var o=n(419);n.n(o).a},550:function(t,e,n){"use strict";var o=n(420);n.n(o).a},681:function(t,e,n){"use strict";n.r(e);var o=n(396),r=(n(29),n(235),{name:"MenuBar",props:{show:{required:!0,type:Boolean},x:{required:!0,type:Number},y:{required:!0,type:Number}},data:function(){return{items:[1,2,3,4,5]}},computed:{style:function(){return{transform:"translate3d(".concat(this.x,"px, ").concat(this.y,"px, 0)")}}},methods:{closeMenu:function(){this.$emit("close")}}}),c=(n(547),n(21)),h=Object(c.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"menu-bar__wrap"},[n("div",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"show"}],staticClass:"menu-bar__mask",on:{click:t.closeMenu}}),t._v(" "),n("transition-group",{staticClass:"menu-bar",style:t.style,attrs:{name:"menu",tag:"div"}},t._l(t.items,(function(e){return n("div",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"show"}],key:e,staticClass:"menu-bar__item",on:{click:function(t){t.stopPropagation()}}})})),0)],1)}),[],!1,null,null,null).exports,l=n(20),d={name:"FloatMenu",components:{MenuBar:h},data:function(){return{leftDown:!1,rightDown:!1,noTouch:!0,beginX:-1,beginY:-1,openMenu:!1}},beforeMount:function(){this.blockRightClick(),Object(l.isTouchDevice)()?this.bindTouch():this.bindPC()},methods:{blockRightClick:function(){document.addEventListener("contextmenu",(function(t){return t.preventDefault()}))},bindTouch:function(){var t=this;document.addEventListener("touchstart",(function(e){t.openMenu||e.touches.length>1&&(t.leftDown=!0,t.rightDown=!0)})),document.addEventListener("touchend",(function(){t.openMenu||(t.leftDown=!1,t.rightDown=!1,t.noTouch=!0)})),document.addEventListener("touchmove",(function(e){if(t.rightDown&&t.leftDown&&!t.openMenu)if(t.noTouch)t.noTouch=!1,t.beginX=e.touches[0].clientX,t.beginY=e.touches[0].clientY;else{var n=t.beginX-e.touches[0].clientX,o=t.beginY-e.touches[0].clientY;o<-100&&Math.abs(n)<Math.abs(o)&&(t.openMenu=!0)}}))},bindPC:function(){var t=this;document.addEventListener("mousedown",(function(e){t.openMenu||(0!==e.button||t.rightDown||(t.leftDown=!0),2===e.button&&t.leftDown&&(t.rightDown=!0))})),document.addEventListener("mouseup",(function(e){t.openMenu||(0===e.button&&(t.leftDown=!1),2===e.button&&(t.rightDown=!1),t.noTouch=!0)})),document.addEventListener("mousemove",(function(e){if(t.rightDown&&t.leftDown&&!t.openMenu)if(t.noTouch)t.noTouch=!1,t.beginX=e.clientX,t.beginY=e.clientY;else{var n=t.beginX-e.clientX,o=t.beginY-e.clientY;o<-100&&Math.abs(n)<Math.abs(o)&&(t.openMenu=!0)}}))},handleClose:function(){this.openMenu=!1,this.leftDown=!1,this.rightDown=!1,this.noTouch=!0}}},menu=Object(c.a)(d,(function(){var t=this.$createElement;return(this._self._c||t)("MenuBar",{attrs:{show:this.openMenu,x:this.beginX,y:this.beginY},on:{close:this.handleClose}})}),[],!1,null,null,null).exports,f=(n(35),n(32),n(118),n(119),n(40),n(17),n(50));n(548);function m(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}var v={name:"Curtain",props:{id:{required:!0,type:String},position:{type:Object,default:null}},data:function(){return{canRender:!1,moving:!1,drag:!1,rect:{top:0,left:0,zIndex:0},startX:0,startY:0,startLeft:0,startTop:0}},computed:{wrapStyle:function(){var rect=this.rect;return{transform:"translate3d(".concat(rect.left,"px, ").concat(rect.top,"px, 0)"),zIndex:rect.zIndex}}},mounted:function(){this.initManager(),this.canRender=!0},beforeDestroy:function(){this.$manager.unbindComponent(this.id)},methods:{initManager:function(){if(this.$manager.componentIsUnique(this.id)){var rect=this.$el.getBoundingClientRect();this.$manager.bindComponent(this.id,this),this.rect=this.$manager.getRect(this.id,this.position?function(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?m(Object(source),!0).forEach((function(e){Object(f.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):m(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}({},this.position,{width:rect.width,height:rect.height}):null)}else console.error("curtain 组件的 id 必须是独一无二的，id：".concat(this.id,"已被注册"))},handleStart:function(t){this.moving=!0,this.startX=t.clientX,this.startY=t.clientY,this.startLeft=this.rect.left,this.startTop=this.rect.top,this.updateIndex()},handleMove:function(t){this.moving&&(this.drag=!0,this.rect.left=this.startLeft+t.clientX-this.startX,this.rect.top=this.startTop+t.clientY-this.startY)},handleEnd:function(){this.drag=!1,this.moving=!1;var rect=this.$el.getBoundingClientRect();this.$manager.setRect(this.id,{top:rect.top,left:rect.left,width:rect.width,height:rect.height,zIndex:this.rect.zIndex})},handleClick:function(){this.updateIndex()},updateIndex:function(){this.rect.zIndex=this.$manager.setMaxIndex(this.id)}},render:function(t){return this.canRender?t("div",{class:["curtain",{"curtain--moving":this.drag}],style:this.wrapStyle,on:{click:this.handleClick}},[t("div",{class:"curtain__header"},[t("div",{class:"curtain__header__menu",attrs:{"data-id":this.id}})]),t("div",{class:"curtain__body"},this.$slots.default)]):t("div",{class:["curtain__placeholder"]},this.$slots.placeholder||this.placeholder)}},w={name:"VTest",components:{},props:{color:{type:String,required:!0}},data:function(){return{}},computed:{},watch:{},created:function(){},mounted:function(){},methods:{}},y=(n(549),{name:"PwaLayout",layout:"empty",components:{Curtain:v,FloatMenu:menu,VTest:Object(c.a)(w,(function(){var t=this.$createElement;return(this._self._c||t)("div",{staticClass:"v-test",style:{backgroundColor:this.color}})}),[],!1,null,null,null).exports},mixins:[o.a]}),$=(n(550),Object(c.a)(y,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"pwa"}},[e("div",{staticClass:"view"},[e("Curtain",{attrs:{id:"test"}},[e("VTest",{attrs:{color:"yellowgreen"}})],1),this._v(" "),e("Curtain",{attrs:{id:"test-2"}},[e("VTest",{attrs:{color:"lightpink"}})],1)],1),this._v(" "),e("FloatMenu",{staticClass:"float-menu"})],1)}),[],!1,null,null,null));e.default=$.exports}}]);