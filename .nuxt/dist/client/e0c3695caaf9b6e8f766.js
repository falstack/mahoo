(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{363:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(128);var o=n(179);function c(t){return function(t){if(Array.isArray(t))return Object(r.a)(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||Object(o.a)(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},366:function(t,e,n){"use strict";e.a={beforeMount:function(){var t=this;this.$channel.$when("user-not-sign",(function(){t.$toast.error("继续操作前请先登录").then((function(){window.location.href=t.$alias.sign()}))}))}}},387:function(t,e,n){"use strict";n(30),n(13),n(72),n(174),n(176),n(19),n(9),n(31),n(37),n(92),n(70),n(71),n(14),n(32),n(18);var r=n(2),o=n(388);e.a={data:function(){return{uploadHeaders:{key:"",token:""},uploadConfig:{max:5},uploadImageLimit:20,imageUploadAccept:["image/jpeg","image/png","image/jpg"].join(", "),imageUploadAction:"https://upload.qiniup.com",imagePrefix:"https://m1.calibur.tv/",getUpTokenTimer:0,uploadPending:0,uploadImageTotal:0,uploadImageList:[]}},computed:{currentUser:function(){return this.$store.state.user},isAuth:function(){return this.$store.state.isAuth}},mounted:function(){var t=this;this.isAuth?this.initUpToken():this.$channel.$when("user-signed",(function(){t.initUpToken()}))},beforeDestroy:function(){this.getUpTokenTimer&&clearInterval(this.getUpTokenTimer)},methods:{initUpToken:function(){var t=this;this.getUpToken(),this.getUpTokenTimer=setInterval((function(){t.getUpToken()}),18e5)},getUpToken:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=t.$cookie.get("UPLOAD-TOKEN"))){e.next=4;break}return t.uploadHeaders.token=t.$cookie.get("UPLOAD-TOKEN"),e.abrupt("return");case 4:return e.next=6,Object(o.a)(t);case 6:n=e.sent,t.uploadHeaders.token=n,t.$cookie.set("UPLOAD-TOKEN",n,{expires:new Date((new Date).getTime()+3e6)});case 9:case"end":return e.stop()}}),e)})))()},handleImageUploadError:function(t,e){var n=this;this.uploadImageList.forEach((function(r,o){r.uid===e.uid&&(n.uploadPending--,n.uploadImageList.splice(o,1),console.log(t))})),this.$toast.error("图片：".concat(e.name," 上传失败"))},handleImageUploadRemove:function(t){var e=this;this.uploadImageList.forEach((function(n,r){n.uid===t.uid&&(e.uploadImageList.splice(r,1),e.uploadImageTotal--)}))},handleImageUploadSuccess:function(t,e){var n=this;this.uploadImageList.forEach((function(r,o){r.uid===e.uid&&(n.uploadImageList[o]=Object.assign(r,{data:t.data,status:"success",url:n.$resizeImage("".concat(n.imagePrefix).concat(t.data.url),{width:100})}))})),this.uploadImageTotal++,this.uploadPending--},handleImageUploadExceed:function(){this.$toast.info("最多还能上传".concat(this.uploadImageLimit-this.uploadImageTotal,"张图片"))},handleImageUploadBefore:function(t){if(!this.isAuth)return this.$channel.$emit("sign-in"),!1;if(!this.imageUploadAccept.split(", ").includes(t.type))return this.$toast.error("仅支持上传".concat(this.imageUploadAccept.replace(/image\//g,"").replace(/, /g,"、"),"格式的图片")),!1;if(this.uploadConfig.max&&this.uploadConfig.max<t.size/1024/1024)return this.$toast.error("图片大小不能超过 ".concat(this.uploadConfig.max,"MB!")),!1;return this.uploadHeaders.key=function(t){var e=t.slug,n=t.file;return"".concat(e,"/").concat((new Date).getTime(),"-").concat(Math.random().toString(36).substring(3,6),".").concat(n.type.split("/").pop())}({slug:this.currentUser.slug,file:t}),this.uploadImageList.push({name:t.name,percentage:0,raw:t,size:t.size,status:"uploading",errMsg:"",uid:t.uid}),this.uploadPending++,!0},resetUploaderStatus:function(){this.uploadImageList=[],this.uploadImageTotal=0,this.uploadPending=0}}}},388:function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return o}));n(30),n(9),n(37);var r=function(t){return t.$axios.$get("v1/image/uptoken")},o=function(t,e){return t.$axios.$post("https://up.qbox.me",e,{"Content-Type":"multipart/form-data"})}},405:function(t,e,n){"use strict";var r=n(3),o=n(55).find,c=n(183),l=n(27),d=!0,h=l("find");"find"in[]&&Array(1).find((function(){d=!1})),r({target:"Array",proto:!0,forced:d||!h},{find:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0)}}),c("find")},406:function(t,e,n){},407:function(t,e,n){},501:function(t,e,n){},502:function(t,e,n){},503:function(t,e,n){},504:function(t,e,n){},505:function(t,e,n){},506:function(t,e,n){"use strict";"undefined"!=typeof window&&(Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector),Element.prototype.closest||(Element.prototype.closest=function(s){var t=this;if(!document.documentElement.contains(t))return null;do{if(t.matches(s))return t;t=t.parentElement||t.parentNode}while(null!==t&&1===t.nodeType);return null}))},507:function(t,e,n){},508:function(t,e,n){},509:function(t,e,n){"use strict";var r=n(406);n.n(r).a},510:function(t,e,n){"use strict";var r=n(407);n.n(r).a},603:function(t,e,n){"use strict";n.r(e);n(30);var r=n(404),o=n.n(r),c=n(366),l=n(387),d=(n(13),n(53),n(173),n(9),n(31),n(44),n(70),n(127),n(14),n(46),n(85)),h=n(388),m=(n(405),n(359),n(22)),v=n(88),f=n(89),w=(n(501),function(){function t(e){var data=e.data,n=e.config,r=e.api;Object(v.a)(this,t),this.api=r,this._CSS={block:this.api.styles.block,settingsButton:this.api.styles.settingsButton,settingsButtonActive:this.api.styles.settingsButtonActive,wrapper:"ce-header"},this._settings=n,this._data=this.normalizeData(data),this.settingsButtons=[],this._element=this.getTag()}return Object(f.a)(t,[{key:"normalizeData",value:function(data){var t={};return"object"!==Object(m.a)(data)&&(data={}),t.text=data.text||"",t.level=parseInt(data.level)||this.defaultLevel.number,t}},{key:"render",value:function(){return this._element}},{key:"renderSettings",value:function(){var t=this,e=document.createElement("DIV");return this.levels.forEach((function(n){var r=document.createElement("SPAN");r.classList.add(t._CSS.settingsButton),t.currentLevel.number===n.number&&r.classList.add(t._CSS.settingsButtonActive),r.innerHTML=n.svg,r.dataset.level=n.number,r.addEventListener("click",(function(){t.setLevel(n.number)})),e.appendChild(r),t.settingsButtons.push(r)})),e}},{key:"setLevel",value:function(t){var e=this;this.data={level:t,text:this.data.text},this.settingsButtons.forEach((function(button){button.classList.toggle(e._CSS.settingsButtonActive,parseInt(button.dataset.level)===t)}))}},{key:"merge",value:function(data){var t={text:this.data.text+data.text,level:this.data.level};this.data=t}},{key:"validate",value:function(t){return""!==t.text.trim()}},{key:"save",value:function(t){return{text:t.innerHTML,level:this.currentLevel.number}}},{key:"getTag",value:function(){var t=document.createElement(this.currentLevel.tag);return t.innerHTML=this._data.text||"",t.classList.add(this._CSS.wrapper),t.contentEditable="true",t.dataset.placeholder=this._settings.placeholder||"",t}},{key:"onPaste",value:function(t){var content=t.detail.data,e=2;switch(content.tagName){case"H1":e=1;break;case"H3":e=3;break;case"H4":e=4;break;case"H5":e=5;break;case"H6":e=6}this.data={level:e,text:content.innerHTML}}},{key:"data",get:function(){return this._data.text=this._element.innerHTML,this._data.level=this.currentLevel.number,this._data},set:function(data){if(this._data=this.normalizeData(data),void 0!==data.level&&this._element.parentNode){var t=this.getTag();t.innerHTML=this._element.innerHTML,this._element.parentNode.replaceChild(t,this._element),this._element=t}void 0!==data.text&&(this._element.innerHTML=this._data.text||"")}},{key:"currentLevel",get:function(){var t=this,e=this.levels.find((function(e){return e.number===t._data.level}));return e||(e=this.defaultLevel),e}},{key:"defaultLevel",get:function(){return this.levels[1]}},{key:"levels",get:function(){return[{number:1,tag:"H1",svg:'<svg width="16" height="14" xmlns="http://www.w3.org/2000/svg"><path d="M2.14 1.494V4.98h4.62V1.494c0-.498.098-.871.293-1.12A.927.927 0 0 1 7.82 0c.322 0 .583.123.782.37.2.246.3.62.3 1.124v9.588c0 .503-.101.88-.303 1.128a.957.957 0 0 1-.779.374.921.921 0 0 1-.77-.378c-.193-.251-.29-.626-.29-1.124V6.989H2.14v4.093c0 .503-.1.88-.302 1.128a.957.957 0 0 1-.778.374.921.921 0 0 1-.772-.378C.096 11.955 0 11.58 0 11.082V1.494C0 .996.095.623.285.374A.922.922 0 0 1 1.06 0c.321 0 .582.123.782.37.199.246.299.62.299 1.124zm11.653 9.985V5.27c-1.279.887-2.14 1.33-2.583 1.33a.802.802 0 0 1-.563-.228.703.703 0 0 1-.245-.529c0-.232.08-.402.241-.511.161-.11.446-.25.854-.424.61-.259 1.096-.532 1.462-.818a5.84 5.84 0 0 0 .97-.962c.282-.355.466-.573.552-.655.085-.082.246-.123.483-.123.267 0 .481.093.642.28.161.186.242.443.242.77v7.813c0 .914-.345 1.371-1.035 1.371-.307 0-.554-.093-.74-.28-.187-.186-.28-.461-.28-.825z"/></svg>'},{number:2,tag:"H2",svg:'<svg width="18" height="14" xmlns="http://www.w3.org/2000/svg"><path d="M2.152 1.494V4.98h4.646V1.494c0-.498.097-.871.293-1.12A.934.934 0 0 1 7.863 0c.324 0 .586.123.786.37.2.246.301.62.301 1.124v9.588c0 .503-.101.88-.304 1.128a.964.964 0 0 1-.783.374.928.928 0 0 1-.775-.378c-.194-.251-.29-.626-.29-1.124V6.989H2.152v4.093c0 .503-.101.88-.304 1.128a.964.964 0 0 1-.783.374.928.928 0 0 1-.775-.378C.097 11.955 0 11.58 0 11.082V1.494C0 .996.095.623.286.374A.929.929 0 0 1 1.066 0c.323 0 .585.123.786.37.2.246.3.62.3 1.124zm10.99 9.288h3.527c.351 0 .62.072.804.216.185.144.277.34.277.588 0 .22-.073.408-.22.56-.146.154-.368.23-.665.23h-4.972c-.338 0-.601-.093-.79-.28a.896.896 0 0 1-.284-.659c0-.162.06-.377.182-.645s.255-.478.399-.631a38.617 38.617 0 0 1 1.621-1.598c.482-.444.827-.735 1.034-.875.369-.261.676-.523.922-.787.245-.263.432-.534.56-.81.129-.278.193-.549.193-.815 0-.288-.069-.546-.206-.773a1.428 1.428 0 0 0-.56-.53 1.618 1.618 0 0 0-.774-.19c-.59 0-1.054.26-1.392.777-.045.068-.12.252-.226.554-.106.302-.225.534-.358.696-.133.162-.328.243-.585.243a.76.76 0 0 1-.56-.223c-.149-.148-.223-.351-.223-.608 0-.31.07-.635.21-.972.139-.338.347-.645.624-.92a3.093 3.093 0 0 1 1.054-.665c.426-.169.924-.253 1.496-.253.69 0 1.277.108 1.764.324.315.144.592.343.83.595.24.252.425.544.558.875.133.33.2.674.2 1.03 0 .558-.14 1.066-.416 1.523-.277.457-.56.815-.848 1.074-.288.26-.771.666-1.45 1.22-.677.554-1.142.984-1.394 1.29a3.836 3.836 0 0 0-.331.44z"/></svg>'},{number:3,tag:"H3",svg:'<svg width="18" height="14" xmlns="http://www.w3.org/2000/svg"><path d="M2.152 1.494V4.98h4.646V1.494c0-.498.097-.871.293-1.12A.934.934 0 0 1 7.863 0c.324 0 .586.123.786.37.2.246.301.62.301 1.124v9.588c0 .503-.101.88-.304 1.128a.964.964 0 0 1-.783.374.928.928 0 0 1-.775-.378c-.194-.251-.29-.626-.29-1.124V6.989H2.152v4.093c0 .503-.101.88-.304 1.128a.964.964 0 0 1-.783.374.928.928 0 0 1-.775-.378C.097 11.955 0 11.58 0 11.082V1.494C0 .996.095.623.286.374A.929.929 0 0 1 1.066 0c.323 0 .585.123.786.37.2.246.3.62.3 1.124zm11.61 4.919c.418 0 .778-.123 1.08-.368.301-.245.452-.597.452-1.055 0-.35-.12-.65-.36-.902-.241-.252-.566-.378-.974-.378-.277 0-.505.038-.684.116a1.1 1.1 0 0 0-.426.306 2.31 2.31 0 0 0-.296.49c-.093.2-.178.388-.255.565a.479.479 0 0 1-.245.225.965.965 0 0 1-.409.081.706.706 0 0 1-.5-.22c-.152-.148-.228-.345-.228-.59 0-.236.071-.484.214-.745a2.72 2.72 0 0 1 .627-.746 3.149 3.149 0 0 1 1.024-.568 4.122 4.122 0 0 1 1.368-.214c.44 0 .842.06 1.205.18.364.12.679.294.947.52.267.228.47.49.606.79.136.3.204.622.204.967 0 .454-.099.843-.296 1.168-.198.324-.48.64-.848.95.354.19.653.408.895.653.243.245.426.516.548.813.123.298.184.619.184.964 0 .413-.083.812-.248 1.198-.166.386-.41.73-.732 1.031a3.49 3.49 0 0 1-1.147.708c-.443.17-.932.256-1.467.256a3.512 3.512 0 0 1-1.464-.293 3.332 3.332 0 0 1-1.699-1.64c-.142-.314-.214-.573-.214-.777 0-.263.085-.475.255-.636a.89.89 0 0 1 .637-.242c.127 0 .25.037.367.112a.53.53 0 0 1 .232.27c.236.63.489 1.099.759 1.405.27.306.65.46 1.14.46a1.714 1.714 0 0 0 1.46-.824c.17-.273.256-.588.256-.947 0-.53-.145-.947-.436-1.249-.29-.302-.694-.453-1.212-.453-.09 0-.231.01-.422.028-.19.018-.313.027-.367.027-.25 0-.443-.062-.579-.187-.136-.125-.204-.299-.204-.521 0-.218.081-.394.245-.528.163-.134.406-.2.728-.2h.28z"/></svg>'},{number:4,tag:"H4",svg:'<svg width="20" height="14" xmlns="http://www.w3.org/2000/svg"><path d="M2.152 1.494V4.98h4.646V1.494c0-.498.097-.871.293-1.12A.934.934 0 0 1 7.863 0c.324 0 .586.123.786.37.2.246.301.62.301 1.124v9.588c0 .503-.101.88-.304 1.128a.964.964 0 0 1-.783.374.928.928 0 0 1-.775-.378c-.194-.251-.29-.626-.29-1.124V6.989H2.152v4.093c0 .503-.101.88-.304 1.128a.964.964 0 0 1-.783.374.928.928 0 0 1-.775-.378C.097 11.955 0 11.58 0 11.082V1.494C0 .996.095.623.286.374A.929.929 0 0 1 1.066 0c.323 0 .585.123.786.37.2.246.3.62.3 1.124zm13.003 10.09v-1.252h-3.38c-.427 0-.746-.097-.96-.29-.213-.193-.32-.456-.32-.788 0-.085.016-.171.048-.259.031-.088.078-.18.141-.276.063-.097.128-.19.195-.28.068-.09.15-.2.25-.33l3.568-4.774a5.44 5.44 0 0 1 .576-.683.763.763 0 0 1 .542-.212c.682 0 1.023.39 1.023 1.171v5.212h.29c.346 0 .623.047.832.142.208.094.313.3.313.62 0 .26-.086.45-.256.568-.17.12-.427.179-.768.179h-.41v1.252c0 .346-.077.603-.23.771-.152.168-.356.253-.612.253a.78.78 0 0 1-.61-.26c-.154-.173-.232-.427-.232-.764zm-2.895-2.76h2.895V4.91L12.26 8.823z"/></svg>'},{number:5,tag:"H5",svg:'<svg width="18" height="14" xmlns="http://www.w3.org/2000/svg"><path d="M2.152 1.494V4.98h4.646V1.494c0-.498.097-.871.293-1.12A.934.934 0 0 1 7.863 0c.324 0 .586.123.786.37.2.246.301.62.301 1.124v9.588c0 .503-.101.88-.304 1.128a.964.964 0 0 1-.783.374.928.928 0 0 1-.775-.378c-.194-.251-.29-.626-.29-1.124V6.989H2.152v4.093c0 .503-.101.88-.304 1.128a.964.964 0 0 1-.783.374.928.928 0 0 1-.775-.378C.097 11.955 0 11.58 0 11.082V1.494C0 .996.095.623.286.374A.929.929 0 0 1 1.066 0c.323 0 .585.123.786.37.2.246.3.62.3 1.124zm14.16 2.645h-3.234l-.388 2.205c.644-.344 1.239-.517 1.783-.517.436 0 .843.082 1.222.245.38.164.712.39.998.677.286.289.51.63.674 1.025.163.395.245.82.245 1.273 0 .658-.148 1.257-.443 1.797-.295.54-.72.97-1.276 1.287-.556.318-1.197.477-1.923.477-.813 0-1.472-.15-1.978-.45-.506-.3-.865-.643-1.076-1.031-.21-.388-.316-.727-.316-1.018 0-.177.073-.345.22-.504a.725.725 0 0 1 .556-.238c.381 0 .665.22.85.66.182.404.427.719.736.943.309.225.654.337 1.035.337.35 0 .656-.09.919-.272.263-.182.466-.431.61-.749.142-.318.214-.678.214-1.082 0-.436-.078-.808-.232-1.117a1.607 1.607 0 0 0-.62-.69 1.674 1.674 0 0 0-.864-.229c-.39 0-.67.048-.837.143-.168.095-.41.262-.725.5-.316.239-.576.358-.78.358a.843.843 0 0 1-.592-.242c-.173-.16-.259-.344-.259-.548 0-.022.025-.177.075-.463l.572-3.26c.063-.39.181-.675.354-.852.172-.177.454-.265.844-.265h3.595c.708 0 1.062.27 1.062.81a.711.711 0 0 1-.26.572c-.172.145-.426.218-.762.218z"/></svg>'},{number:6,tag:"H6",svg:'<svg width="18" height="14" xmlns="http://www.w3.org/2000/svg"><path d="M2.152 1.494V4.98h4.646V1.494c0-.498.097-.871.293-1.12A.934.934 0 0 1 7.863 0c.324 0 .586.123.786.37.2.246.301.62.301 1.124v9.588c0 .503-.101.88-.304 1.128a.964.964 0 0 1-.783.374.928.928 0 0 1-.775-.378c-.194-.251-.29-.626-.29-1.124V6.989H2.152v4.093c0 .503-.101.88-.304 1.128a.964.964 0 0 1-.783.374.928.928 0 0 1-.775-.378C.097 11.955 0 11.58 0 11.082V1.494C0 .996.095.623.286.374A.929.929 0 0 1 1.066 0c.323 0 .585.123.786.37.2.246.3.62.3 1.124zM12.53 7.058a3.093 3.093 0 0 1 1.004-.814 2.734 2.734 0 0 1 1.214-.264c.43 0 .827.08 1.19.24.365.161.684.39.957.686.274.296.485.645.635 1.048a3.6 3.6 0 0 1 .223 1.262c0 .637-.145 1.216-.437 1.736-.292.52-.699.926-1.221 1.218-.522.292-1.114.438-1.774.438-.76 0-1.416-.186-1.967-.557-.552-.37-.974-.919-1.265-1.645-.292-.726-.438-1.613-.438-2.662 0-.855.088-1.62.265-2.293.176-.674.43-1.233.76-1.676.33-.443.73-.778 1.2-1.004.47-.226 1.006-.339 1.608-.339.579 0 1.089.113 1.53.34.44.225.773.506.997.84.224.335.335.656.335.964 0 .185-.07.354-.21.505a.698.698 0 0 1-.536.227.874.874 0 0 1-.529-.18 1.039 1.039 0 0 1-.36-.498 1.42 1.42 0 0 0-.495-.655 1.3 1.3 0 0 0-.786-.247c-.24 0-.479.069-.716.207a1.863 1.863 0 0 0-.6.56c-.33.479-.525 1.333-.584 2.563zm1.832 4.213c.456 0 .834-.186 1.133-.56.298-.373.447-.862.447-1.468 0-.412-.07-.766-.21-1.062a1.584 1.584 0 0 0-.577-.678 1.47 1.47 0 0 0-.807-.234c-.28 0-.548.074-.804.224-.255.149-.461.365-.617.647a2.024 2.024 0 0 0-.234.994c0 .61.158 1.12.475 1.527.316.407.714.61 1.194.61z"/></svg>'}]}}],[{key:"conversionConfig",get:function(){return{export:"text",import:"text"}}},{key:"sanitize",get:function(){return{level:{}}}},{key:"pasteConfig",get:function(){return{tags:["H1","H2","H3","H4","H5","H6"]}}},{key:"toolbox",get:function(){return{icon:'<svg width="11" height="14" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M7.6 8.15H2.25v4.525a1.125 1.125 0 0 1-2.25 0V1.125a1.125 1.125 0 1 1 2.25 0V5.9H7.6V1.125a1.125 1.125 0 0 1 2.25 0v11.55a1.125 1.125 0 0 1-2.25 0V8.15z"/></svg>',title:"标题"}}}]),t}()),k=(n(19),n(37),n(502),function(){function t(e){var data=e.data;Object(v.a)(this,t),this.data=data}return Object(f.a)(t,[{key:"render",value:function(){var t=document.createElement("div");t.classList.add("baidu-resource");var e=document.createElement("i");e.classList.add("iconfont","ic-baidu-cloud","baidu-resource-icon"),t.appendChild(e);var n=document.createElement("div");n.classList.add("baidu-resource-wrap"),t.appendChild(n);var r=document.createElement("input");r.classList.add("baidu-resource-url"),r.placeholder="粘贴资源链接到这里（仅支持百度云盘：pan.baidu.com）",r.type="text",r.value=this.data&&this.data.url?this.data.url:"",n.appendChild(r);var o=document.createElement("input");o.classList.add("baidu-resource-password"),o.placeholder="填写资源的密码（4~6位）",o.type="text",o.value=this.data&&this.data.password?this.data.password:"",n.appendChild(o);var c=document.createElement("div");c.classList.add("baidu-resource-role-wrap");var l="".concat(Math.random().toString(36).substring(3,6)),d=this.data&&this.data.visit_type?this.data.visit_type:0,h=document.createElement("span");h.textContent="是否需要投食才能看到密码：",c.appendChild(h);var m=document.createElement("input");m.classList.add("baidu-resource-role-public"),m.id="baidu-resource-role-public-".concat(l),m.name=l,m.type="radio",m.value=0,m.checked=0===d,c.appendChild(m);var v=document.createElement("label");v.setAttribute("for","baidu-resource-role-public-".concat(l)),v.textContent="否",v.classList.add("baidu-resource-label"),c.appendChild(v);var f=document.createElement("input");f.classList.add("baidu-resource-role-private"),f.id="baidu-resource-role-private-".concat(l),f.type="radio",f.name=l,f.value=1,f.checked=1===d,c.appendChild(f);var w=document.createElement("label");return w.setAttribute("for","baidu-resource-role-private-".concat(l)),w.textContent="是",w.classList.add("baidu-resource-label"),c.appendChild(w),n.appendChild(c),t}},{key:"save",value:function(t){var e=t.querySelector(".baidu-resource-url"),n=t.querySelector(".baidu-resource-password"),r=t.querySelector(".baidu-resource-role-public"),o=e.value.trim();return/^https?:\/\//.test(o)||(o="https://"+o),{url:o,password:n.value.trim(),visit_type:r.checked?0:1}}},{key:"validate",value:function(t){return!(!t.url||!t.password)&&!(!/https?:\/\/pan\.baidu\.com\/s\/([\w\W]+)/.test(t.url)||!/^[\w|\W]{4,6}$/.test(t.password))}}],[{key:"toolbox",get:function(){return{title:"百度云",icon:'<svg version="1" xmlns="http://www.w3.org/2000/svg" width="28px" height="28px" viewBox="0 0 298 298" preserveAspectRatio="xMidYMid meet"><g stroke="none"><path d="M135.2 75.6c-11 2.9-20.1 9.5-26.5 19.1-5.1 7.6-7.4 14.6-8.4 24.5-.6 7.4.2 6.7-9.8 8.4-15.2 2.6-30.5 16.1-35.6 31.2-1.8 5.4-2 8.1-1.7 17.5.4 10.6.6 11.6 4.2 18.6 6.5 12.8 17.1 20.9 31.9 24.8 12.1 3.1 26.8.2 37.9-7.5 2.4-1.6 12.2-11.9 21.8-22.8 32.9-37.3 35.7-39.7 46.5-39.7 12.9.1 21.4 8.4 24 23.6.3 2.2 1.1 4.9 1.6 6.1 2.3 5.1 11.4 7.3 16.4 4 12.6-8.3-.4-41.6-19.8-50.8-5.8-2.7-16.1-5.6-20.1-5.6-2.4 0-2.6-.3-2.6-4.4 0-21.7-15.1-41.8-35.4-47.2-6.5-1.7-17.6-1.7-24.4.2zm19.4 21.9c5.7 1.7 12.8 8 15.2 13.5 1.9 4.5 1.8 14.5-.2 19.1-3.7 8.7-12.1 13.9-22.4 13.9-6.2 0-7.5-.4-11.8-3.3-7.4-4.9-10.7-10.4-11.2-18.3-.6-8.7 1.5-14.1 7.8-19.7 7.3-6.6 13.4-8 22.6-5.2zm-44.7 54.4c5 2.6 10.7 9.1 12 13.8 4.6 16.4-5.9 31.5-21.8 31.5-13.6.1-24.1-10-24.1-23.2 0-9.3 5.7-18.6 13.5-22.1 5.5-2.5 15.4-2.5 20.4 0zM225 200.7c-3.9 2.7-4.9 4.5-5 9 0 3.3.6 5 2.9 7.5 2.6 2.9 3.5 3.3 8.1 3.3s5.5-.4 8.1-3.3c6.4-7.2 2.1-18.2-7.3-18.2-2.5 0-5.4.7-6.8 1.7z"/></g></svg>'}}}]),t}()),y=(n(503),function(){function t(e){var data=e.data,n=(e.config,e.api);Object(v.a)(this,t),this.api=n,this._CSS={block:this.api.styles.block,wrapper:"ce-delimiter"},this._data={},this._element=this.drawView(),this.data=data}return Object(f.a)(t,null,[{key:"contentless",get:function(){return!0}}]),Object(f.a)(t,[{key:"drawView",value:function(){var div=document.createElement("DIV");return div.classList.add(this._CSS.wrapper,this._CSS.block),div}},{key:"render",value:function(){return this._element}},{key:"save",value:function(t){return{}}}],[{key:"toolbox",get:function(){return{icon:'<svg width="19" height="4" viewBox="0 0 19 4" xmlns="http://www.w3.org/2000/svg"><path d="M1.25 0H7a1.25 1.25 0 1 1 0 2.5H1.25a1.25 1.25 0 1 1 0-2.5zM11 0h5.75a1.25 1.25 0 0 1 0 2.5H11A1.25 1.25 0 0 1 11 0z"/></svg>',title:"分割线"}}}]),t}()),_=(n(43),n(56),n(174),n(363)),x=(n(504),function(){function t(e){var data=e.data,n=(e.config,e.api);Object(v.a)(this,t),this._elements={wrapper:null},this.settings=[{name:"unordered",title:"Unordered",icon:'<svg width="17" height="13" viewBox="0 0 17 13" xmlns="http://www.w3.org/2000/svg"> <path d="M5.625 4.85h9.25a1.125 1.125 0 0 1 0 2.25h-9.25a1.125 1.125 0 0 1 0-2.25zm0-4.85h9.25a1.125 1.125 0 0 1 0 2.25h-9.25a1.125 1.125 0 0 1 0-2.25zm0 9.85h9.25a1.125 1.125 0 0 1 0 2.25h-9.25a1.125 1.125 0 0 1 0-2.25zm-4.5-5a1.125 1.125 0 1 1 0 2.25 1.125 1.125 0 0 1 0-2.25zm0-4.85a1.125 1.125 0 1 1 0 2.25 1.125 1.125 0 0 1 0-2.25zm0 9.85a1.125 1.125 0 1 1 0 2.25 1.125 1.125 0 0 1 0-2.25z"/></svg>',default:!1},{name:"ordered",title:"Ordered",icon:'<svg width="17" height="13" viewBox="0 0 17 13" xmlns="http://www.w3.org/2000/svg"><path d="M5.819 4.607h9.362a1.069 1.069 0 0 1 0 2.138H5.82a1.069 1.069 0 1 1 0-2.138zm0-4.607h9.362a1.069 1.069 0 0 1 0 2.138H5.82a1.069 1.069 0 1 1 0-2.138zm0 9.357h9.362a1.069 1.069 0 0 1 0 2.138H5.82a1.069 1.069 0 0 1 0-2.137zM1.468 4.155V1.33c-.554.404-.926.606-1.118.606a.338.338 0 0 1-.244-.104A.327.327 0 0 1 0 1.59c0-.107.035-.184.105-.234.07-.05.192-.114.369-.192.264-.118.475-.243.633-.373.158-.13.298-.276.42-.438a3.94 3.94 0 0 1 .238-.298C1.802.019 1.872 0 1.975 0c.115 0 .208.042.277.127.07.085.105.202.105.351v3.556c0 .416-.15.624-.448.624a.421.421 0 0 1-.32-.127c-.08-.085-.121-.21-.121-.376zm-.283 6.664h1.572c.156 0 .275.03.358.091a.294.294 0 0 1 .123.25.323.323 0 0 1-.098.238c-.065.065-.164.097-.296.097H.629a.494.494 0 0 1-.353-.119.372.372 0 0 1-.126-.28c0-.068.027-.16.081-.273a.977.977 0 0 1 .178-.268c.267-.264.507-.49.722-.678.215-.188.368-.312.46-.371.165-.11.302-.222.412-.334.109-.112.192-.226.25-.344a.786.786 0 0 0 .085-.345.6.6 0 0 0-.341-.553.75.75 0 0 0-.345-.08c-.263 0-.47.11-.62.329-.02.029-.054.107-.101.235a.966.966 0 0 1-.16.295c-.059.069-.145.103-.26.103a.348.348 0 0 1-.25-.094.34.34 0 0 1-.099-.258c0-.132.031-.27.093-.413.063-.143.155-.273.279-.39.123-.116.28-.21.47-.282.189-.072.411-.107.666-.107.307 0 .569.045.786.137a1.182 1.182 0 0 1 .618.623 1.18 1.18 0 0 1-.096 1.083 2.03 2.03 0 0 1-.378.457c-.128.11-.344.282-.646.517-.302.235-.509.417-.621.547a1.637 1.637 0 0 0-.148.187z"/></svg>',default:!0}],this._data={style:this.settings.find((function(t){return!0===t.default})).name,items:[]},this.api=n,this.data=data}return Object(f.a)(t,null,[{key:"enableLineBreaks",get:function(){return!0}},{key:"toolbox",get:function(){return{icon:'<svg width="17" height="13" viewBox="0 0 17 13" xmlns="http://www.w3.org/2000/svg"> <path d="M5.625 4.85h9.25a1.125 1.125 0 0 1 0 2.25h-9.25a1.125 1.125 0 0 1 0-2.25zm0-4.85h9.25a1.125 1.125 0 0 1 0 2.25h-9.25a1.125 1.125 0 0 1 0-2.25zm0 9.85h9.25a1.125 1.125 0 0 1 0 2.25h-9.25a1.125 1.125 0 0 1 0-2.25zm-4.5-5a1.125 1.125 0 1 1 0 2.25 1.125 1.125 0 0 1 0-2.25zm0-4.85a1.125 1.125 0 1 1 0 2.25 1.125 1.125 0 0 1 0-2.25zm0 9.85a1.125 1.125 0 1 1 0 2.25 1.125 1.125 0 0 1 0-2.25z"/></svg>',title:"列表"}}}]),Object(f.a)(t,[{key:"render",value:function(){var t=this,style="ordered"===this._data.style?this.CSS.wrapperOrdered:this.CSS.wrapperUnordered;return this._elements.wrapper=this._make("ul",[this.CSS.baseBlock,this.CSS.wrapper,style],{contentEditable:!0}),this._data.items.length?this._data.items.forEach((function(e){t._elements.wrapper.appendChild(t._make("li",t.CSS.item,{innerHTML:e}))})):this._elements.wrapper.appendChild(this._make("li",this.CSS.item)),this._elements.wrapper.addEventListener("keydown",(function(e){switch(e.keyCode){case 13:t.getOutofList(e);break;case 8:t.backspace(e)}}),!1),this._elements.wrapper}},{key:"save",value:function(){return this.data}},{key:"renderSettings",value:function(){var t=this,e=this._make("div",[this.CSS.settingsWrapper],{});return this.settings.forEach((function(n){var r=t._make("div",t.CSS.settingsButton,{innerHTML:n.icon});r.addEventListener("click",(function(){t.toggleTune(n.name);var e=r.parentNode.querySelectorAll("."+t.CSS.settingsButton);Array.from(e).forEach((function(button){return button.classList.remove(t.CSS.settingsButtonActive)})),r.classList.toggle(t.CSS.settingsButtonActive)})),t._data.style===n.name&&r.classList.add(t.CSS.settingsButtonActive),e.appendChild(r)})),e}},{key:"onPaste",value:function(t){var e=t.detail.data;this.data=this.pasteHandler(e)}},{key:"toggleTune",value:function(style){this._elements.wrapper.classList.toggle(this.CSS.wrapperOrdered,"ordered"===style),this._elements.wrapper.classList.toggle(this.CSS.wrapperUnordered,"unordered"===style),this._data.style=style}},{key:"_make",value:function(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=document.createElement(t);Array.isArray(n)?(e=o.classList).add.apply(e,Object(_.a)(n)):n&&o.classList.add(n);for(var c in r)o[c]=r[c];return o}},{key:"getOutofList",value:function(t){var e=this._elements.wrapper.querySelectorAll("."+this.CSS.item);if(!(e.length<2)){var n=e[e.length-1],r=this.currentItem;r!==n||n.textContent.trim().length||(r.parentElement.removeChild(r),this.api.blocks.insertNewBlock(),t.preventDefault(),t.stopPropagation())}}},{key:"backspace",value:function(t){var e=this._elements.wrapper.querySelectorAll("."+this.CSS.item),n=e[0];n&&e.length<2&&!n.innerHTML.replace("<br>"," ").trim()&&t.preventDefault()}},{key:"selectItem",value:function(t){t.preventDefault();var e=window.getSelection(),n=e.anchorNode.parentNode.closest("."+this.CSS.item),r=new Range;r.selectNodeContents(n),e.removeAllRanges(),e.addRange(r)}},{key:"pasteHandler",value:function(element){var t,e=element.tagName;switch(e){case"OL":t="ordered";break;case"UL":case"LI":t="unordered"}var data={type:t,items:[]};if("LI"===e)data.items=[element.innerHTML];else{var n=Array.from(element.querySelectorAll("LI"));data.items=n.map((function(li){return li.innerHTML})).filter((function(t){return!!t.trim()}))}return data}},{key:"CSS",get:function(){return{baseBlock:this.api.styles.block,wrapper:"cdx-list",wrapperOrdered:"cdx-list--ordered",wrapperUnordered:"cdx-list--unordered",item:"cdx-list__item",settingsWrapper:"cdx-list-settings",settingsButton:this.api.styles.settingsButton,settingsButtonActive:this.api.styles.settingsButtonActive}}},{key:"data",set:function(t){t||(t={}),this._data.style=t.style||this.settings.find((function(t){return!0===t.default})).name,this._data.items=t.items||[];var e=this._elements.wrapper;e&&e.parentNode.replaceChild(this.render(),e)},get:function(){this._data.items=[];for(var t=this._elements.wrapper.querySelectorAll(".".concat(this.CSS.item)),i=0;i<t.length;i++){t[i].innerHTML.replace("<br>"," ").trim()&&this._data.items.push(t[i].innerHTML)}return this._data}},{key:"currentItem",get:function(){var t=window.getSelection().anchorNode;return t.nodeType!==Node.ELEMENT_NODE&&(t=t.parentNode),t.closest(".".concat(this.CSS.item))}}],[{key:"conversionConfig",get:function(){return{export:function(data){return data.items.join(". ")},import:function(t){return{items:[t],style:"unordered"}}}}},{key:"sanitize",get:function(){return{style:{},items:{br:!0}}}},{key:"pasteConfig",get:function(){return{tags:["OL","UL","LI"]}}}]),t}()),C=(n(91),n(176),n(505),n(506),function(){function t(e){var data=e.data,n=(e.config,e.api);Object(v.a)(this,t),this._elements={wrapper:null,items:[]},this._data={items:[]},this.api=n,this.data=data}return Object(f.a)(t,null,[{key:"enableLineBreaks",get:function(){return!0}},{key:"toolbox",get:function(){return{icon:'<svg width="15" height="15" viewBox="0 0 15 15" xmlns="http://www.w3.org/2000/svg"><path d="M7.5 15a7.5 7.5 0 1 1 0-15 7.5 7.5 0 0 1 0 15zm0-2.394a5.106 5.106 0 1 0 0-10.212 5.106 5.106 0 0 0 0 10.212zm-.675-4.665l2.708-2.708 1.392 1.392-2.708 2.708-1.392 1.391-2.971-2.971L5.245 6.36l1.58 1.58z"/></svg>',title:"进度表"}}}]),Object(f.a)(t,[{key:"render",value:function(){var t=this;if(this._elements.wrapper=this._make("div",[this.CSS.baseBlock,this.CSS.wrapper]),this._data.items.length)this._data.items.forEach((function(e){var n=t.createChecklistItem(e);t._elements.items.push(n),t._elements.wrapper.appendChild(n)}));else{var e=this.createChecklistItem();this._elements.items.push(e),this._elements.wrapper.appendChild(e)}return this._elements.wrapper.addEventListener("keydown",(function(e){switch(e.keyCode){case 13:t.appendNewElement(e);break;case 8:t.backspace(e)}}),!1),this._elements.wrapper.addEventListener("click",(function(e){t.toggleCheckbox(e)})),this._elements.wrapper}},{key:"validate",value:function(t){return!!t.items.length}},{key:"toggleCheckbox",value:function(t){var e=t.target.closest(".".concat(this.CSS.item));e.querySelector(".".concat(this.CSS.checkbox)).contains(t.target)&&e.classList.toggle(this.CSS.itemChecked)}},{key:"createChecklistItem",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=this._make("div",this.CSS.item),n=this._make("span",this.CSS.checkbox),r=this._make("div",this.CSS.textField,{innerHTML:t.text?t.text:"",contentEditable:!0});return t.checked&&e.classList.add(this.CSS.itemChecked),e.appendChild(n),e.appendChild(r),e}},{key:"appendNewElement",value:function(t){t.preventDefault();var e=window.getSelection().anchorNode,n=this._elements.items[this._elements.items.length-1].querySelector(".".concat(this.CSS.textField)),r=n.innerHTML.replace("<br>"," ").trim();if(e===n&&!r)return this.api.blocks.insertNewBlock(),void t.stopPropagation();var o=this.createChecklistItem(),c=e.parentNode.closest(".".concat(this.CSS.item));this._elements.wrapper.insertBefore(o,c.nextSibling);var l=this._elements.items.indexOf(c)+1;this._elements.items.splice(l,0,o),this.moveCaretToEnd(o.querySelector(".".concat(this.CSS.textField)))}},{key:"backspace",value:function(t){var e=t.target.closest(".".concat(this.CSS.item)),n=this._elements.items.indexOf(e),r=e.querySelector(".".concat(this.CSS.textField)).innerHTML.replace("<br>"," ").trim();this._elements.items[0].querySelector(".".concat(this.CSS.textField)).innerHTML.replace("<br>"," ").trim()&&n&&!r&&(t.preventDefault(),e.remove(),this._elements.items.splice(n,1),"undefined"!==this._elements.items[n-1]&&this.moveCaretToEnd(this._elements.items[n-1].querySelector(".".concat(this.CSS.textField))))}},{key:"save",value:function(){return this.data}},{key:"_make",value:function(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=document.createElement(t);Array.isArray(n)?(e=o.classList).add.apply(e,Object(_.a)(n)):n&&o.classList.add(n);for(var c in r)o[c]=r[c];return o}},{key:"moveCaretToEnd",value:function(element){var t=document.createRange(),e=window.getSelection();t.selectNodeContents(element),t.collapse(!1),e.removeAllRanges(),e.addRange(t)}},{key:"CSS",get:function(){return{baseBlock:this.api.styles.block,wrapper:"cdx-checklist",item:"cdx-checklist__item",itemChecked:"cdx-checklist__item--checked",checkbox:"cdx-checklist__item-checkbox",textField:"cdx-checklist__item-text"}}},{key:"data",set:function(t){this._data.items=t.items||[];var e=this._elements.wrapper;e&&e.parentNode.replaceChild(this.render(),e)},get:function(){this._data.items=[];for(var i=0;i<this._elements.items.length;i++){var t=this._elements.items[i].querySelector(".".concat(this.CSS.textField)).innerHTML.replace("<br>"," ").trim();t&&this._data.items.push({text:t,checked:this._elements.items[i].classList.contains(this.CSS.itemChecked)})}return this._data}}]),t}()),S=(n(507),function(){function t(e){var data=e.data,n=e.config,r=e.api;Object(v.a)(this,t),this.api=r,this._CSS={block:this.api.styles.block,wrapper:"ce-paragraph"},this.onKeyUp=this.onKeyUp.bind(this),this._placeholder=n.placeholder?n.placeholder:t.DEFAULT_PLACEHOLDER,this._data={},this._element=this.drawView(),/^<input /gi.test(data.text)&&(data={}),this.data=data}return Object(f.a)(t,null,[{key:"DEFAULT_PLACEHOLDER",get:function(){return""}}]),Object(f.a)(t,[{key:"onKeyUp",value:function(t){"Backspace"!==t.code&&"Delete"!==t.code||""===this._element.textContent&&(this._element.innerHTML="")}},{key:"drawView",value:function(){var div=document.createElement("DIV");return div.classList.add(this._CSS.wrapper,this._CSS.block),div.contentEditable=!0,div.dataset.placeholder=this._placeholder,div.addEventListener("keyup",this.onKeyUp),div}},{key:"render",value:function(){return this._element}},{key:"merge",value:function(data){this.data={text:this.data.text+data.text}}},{key:"validate",value:function(t){return!(""===t.text.trim()||/vanced issues found/.test(t.text))}},{key:"save",value:function(t){return{text:t.innerHTML}}},{key:"onPaste",value:function(t){this.data={text:t.detail.data.innerHTML}}},{key:"data",get:function(){return this._data.text=this._element.innerHTML,this._data},set:function(data){this._data=data||{},this._element.innerHTML=this._data.text||""}}],[{key:"conversionConfig",get:function(){return{export:"text",import:"text"}}},{key:"sanitize",get:function(){return{text:{br:!0}}}},{key:"pasteConfig",get:function(){return{tags:["P"]}}}]),t}()),L=(n(71),n(508),function(){function t(e){var data=e.data,n=e.api;Object(v.a)(this,t),this.data=data,this.api=n,this.i=0}return Object(f.a)(t,[{key:"render",value:function(){var t=this;if(!(document.querySelectorAll(".vote-wrap").length>0)){var e=document.createElement("div");e.classList.add("vote-wrap");var n=document.createElement("p");n.textContent="投票（文章发表后无法再修改）";var r=document.createElement("ul"),o=document.createElement("button");o.classList.add("vote-append","el-icon-plus");var c=function(text){var n=document.createElement("li"),label=document.createElement("span");label.textContent="".concat(++t.i,". ");var input=document.createElement("input");if(input.type="text",input.placeholder="请输入选项（20字以内）",text&&(input.value=("string"==typeof text?text:text.text)||""),input.maxLength=20,input.classList.add("vote-answer"),n.classList.add("vote-wrap-item"),n.appendChild(label),n.appendChild(input),t.i>2){var c=document.createElement("button");c.classList.add("el-icon-circle-close"),c.addEventListener("click",(function(){r.removeChild(n),t.i--,t.i<100&&(o.style.display="block");var c=e.querySelector(".vote-wrap-select-count");c&&(c.max=t.i,c.value-t.i>0&&(c.value=t.i))})),n.appendChild(c)}r.appendChild(n),input.focus()};o.addEventListener("click",(function(){c(),t.i>=100&&(o.style.display="none");var n=e.querySelector(".vote-wrap-select-count");n&&(n.max=t.i)}));return e.appendChild(n),e.appendChild(r),e.appendChild(o),this.data&&this.data.items?this.data.items.forEach(c):(c(),c()),function(){var footer=document.createElement("footer"),n=document.createElement("span");n.textContent="可选个数";var r=document.createElement("input");r.type="number",r.classList.add("vote-wrap-select-count"),r.min=1,t.data&&t.data.max_select?r.value=t.data.max_select:r.value=1,r.max=t.i,footer.appendChild(n),footer.appendChild(r);var o=document.createElement("span");o.textContent="截止时间（可选）";var c=document.createElement("input");c.type="date",c.min=new Date(Date.now()+864e5).toISOString().split("T")[0],c.classList.add("vote-expire-input"),t.data&&t.data.expired_at&&(c.value=new Date(1e3*t.data.expired_at).toISOString().split("T")[0]),footer.appendChild(o),footer.appendChild(c),e.appendChild(footer)}(),e}this.api.notifier.show({message:"一篇文章只能包含一个投票",style:"error"})}},{key:"save",value:function(t){var e=t.querySelectorAll(".vote-answer"),n=[];[].forEach.call(e,(function(t){n.push(t.value)}));var r=t.querySelector(".vote-expire-input");return{items:n.map((function(t){return t.trim()})).filter((function(t){return t})),right_ids:[],max_select:+t.querySelector(".vote-wrap-select-count").value,expired_at:r&&r.value?parseInt(new Date(r.value).getTime()/1e3):0}}},{key:"validate",value:function(t){return t.items.length>1}}],[{key:"toolbox",get:function(){return{title:"投票",icon:'<svg version="1" xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" viewBox="0 0 300 298" preserveAspectRatio="xMidYMid meet"><g stroke="none"><path d="M109.5 62.4l-2.5 2.5v140.2l2.5 2.4c2.3 2.4 3 2.5 14.7 2.5 6.8 0 13.3-.3 14.6-.6 5.2-1.4 5.2-.8 5.2-75.1 0-66.3-.1-68.9-2-71.3-1.8-2.4-2.3-2.5-15.9-2.8-13.9-.3-14.1-.3-16.6 2.2zM50.2 100l-2.2 2.1v103.8l2.6 2c2.4 1.9 4 2.1 15 2.1 13.8 0 16.8-.9 18.4-5.3 1.4-4.2 1.4-97.3-.1-101.6-.6-1.7-1.9-3.6-2.9-4.1-1-.6-7.9-1-15.2-1-12.1 0-13.6.2-15.6 2zM230.4 109.4c-1.7.8-3.4 2.1-3.8 3.1-.3.9-.6 22.1-.6 47.1v45.5l2.5 2.4c2.3 2.4 3 2.5 14.9 2.5 14 0 17-.9 18.6-5.3 1.5-4.3 1.4-86.3-.1-90.7-.8-2.2-2.2-3.7-4.5-4.6-4.4-1.8-22.7-1.8-27 0zM170.3 158.2c-1.2.6-2.7 2.4-3.2 4.1-1.4 3.9-1.4 38.5-.1 42.4 1.6 4.4 4.6 5.3 18.6 5.3 11.9 0 12.6-.1 14.9-2.5 2.5-2.4 2.5-2.4 2.5-24s0-21.6-2.5-24c-2.3-2.4-2.9-2.5-15.2-2.4-7 0-13.8.5-15 1.1zM49.2 223.2c-1.9 1.9-1.5 6.6.7 7.8 1.3.7 36 1 105.3 1 84.4 0 103.8-.2 105.2-1.3 2.2-1.6 2.5-6.5.5-7.8-2.3-1.4-210.3-1.1-211.7.3z"/></g></svg>'}}}]),t}()),E={name:"JsonEditor",mixins:[l.a],props:{value:{required:!0,type:Array},slug:{type:String,default:""},time:{type:[String,Number],default:""},autofocus:{type:Boolean,default:!1}},data:function(){return{editor:null}},mounted:function(){this.initEditor()},methods:{initEditor:function(){var t=this;Promise.all([n.e(37).then(n.t.bind(null,597,7)),n.e(35).then(n.bind(null,622)),Promise.all([n.e(34),n.e(36)]).then(n.bind(null,598))]).then((function(e){var n=t,data={};if(n.slug){var r=n.$cache.get("editor_local_draft-".concat(n.slug));data=r&&r.time>n.$utils.adjustDate(n.time).getTime()?r:{blocks:n.value,time:Date.now(),version:n.$cache.get("editor_version","2.15.0")}}else(data=n.$cache.get("editor_local_draft-"))&&n.$emit("input",data.blocks);var o=e.map((function(t){return t.default})),c=Object(d.a)(o,3),l=c[0],m=c[1],v=c[2],f=new l({data:n.decodeData(data||{}),holder:"codex-editor",placeholder:"请输入内容",autofocus:n.autofocus,tools:{header:{class:w,inlineToolbar:!0},image:{class:m,types:"image/jpeg, image/png, image/jpg",config:{uploader:{uploadByFile:function(t){return new Promise((function(e,r){var o=new FormData;o.append("file",t),o.append("token",n.uploadHeaders.token),Object(h.b)(n,o).then((function(data){data.url="https://m1.calibur.tv/".concat(data.url),e({success:1,file:data})})).catch(r)}))}}}},link:{class:v,config:{endpoint:"".concat("https://api.calibur.tv/","v1/pin/editor/fetch_site")}},delimiter:{class:y},list:{class:x,inlineToolbar:!0},checklist:{class:C,inlineToolbar:!0},baidu:{class:k},paragraph:{class:S},vote:{class:L}},onChange:function(){n.handleSave()}});f.isReady.then((function(){t.editor=f,t.bindSaveEvent(),t.handleSave()})).catch((function(e){t.$toast.error("编辑器初始化失败：".concat(e))}))}))},bindSaveEvent:function(){var t=this;document.addEventListener("keydown",(function(e){83===e.keyCode&&(e.ctrlKey||e.metaKey)&&(e.stopPropagation(),e.preventDefault(),t.handleSave())}),!1)},handleSave:function(){var t=this;this.editor&&this.editor.save().then((function(e){var n=t.encodeData(e),r="editor_local_draft-".concat(t.slug||"");t.$cache.set(r,n),t.$cache.set("editor_version",n.version),t.value&&t.$emit("input",n.blocks),t.$emit("save")})).catch((function(){t.$toast.error("保存失败")}))},decodeData:function(t){var e=t.version,n=t.blocks,time=t.time;return n?(n.forEach((function(t,e){"music"===t.type&&(n[e].type="video")})),{version:e,blocks:n,time:time}):null},encodeData:function(t){var e=t.version,n=t.blocks,time=t.time;return n.forEach((function(t,e){"video"===t.type&&t.data.service.startsWith("netease")&&(n[e].type="music",n[e].data.embed=n[e].data.embed.replace(/&amp;/g,"&"))})),{version:e,blocks:n,time:time}}}},T=(n(509),n(7)),H={name:"Write",components:{Editor:Object(T.a)(E,(function(){var t=this.$createElement;this._self._c;return this._m(0)}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"editor-wrap"},[e("div",{staticClass:"mousetrap",attrs:{id:"codex-editor"}})])}],!1,null,null,null).exports,ElUpload:o.a},mixins:[c.a,l.a],asyncData:function(t){var e=t.app,n=t.error,r=t.query.slug;if(r)return e.$axios.$get("v1/pin/update/content",{params:{slug:r}}).then((function(data){return data})).catch(n)},data:function(){return{slug:"",title:{banner:null,text:""},content:[],notebook:"",area:"",topic:"",last_edit_at:"",published_at:"",loading:!1}},mounted:function(){this.$cache.has("editor_local_draft_title-".concat(this.slug))&&(this.title=this.$cache.get("editor_local_draft_title-".concat(this.slug)))},methods:{customImageUploadSuccess:function(t,e){this.handleImageUploadSuccess(t,e);var n=t.data;if(n.width<960||n.height<540)return this.handleImageUploadRemove(e),void this.$toast.info("图片尺寸不符合要求");this.title.banner=n,this.saveTitle()},onEditorSave:function(){this.saveTitle()},saveTitle:function(){this.$cache.set("editor_local_draft_title-".concat(this.slug),this.title)},deleteBanner:function(){this.title.banner=null,this.saveTitle()},preValidate:function(){return!!this.loading||(this.title.text?this.content.length?(this.loading=!0,!1):(this.$toast.info("内容不能为空"),!0):(this.$toast.info("标题不能为空"),!0))},actionCreate:function(t){var e=this;this.preValidate()||this.$axios.$post("v1/pin/create/story",{notebook:this.notebook,content:[{type:"title",data:this.title}].concat(this.content),publish:t}).then((function(n){e.removeCache(),window.location=t?e.$alias.pin(n):e.$alias.create(n)})).catch((function(t){e.$toast.error(t.message),e.loading=!1}))},actionUpdate:function(t){var e=this;if(!this.preValidate()){var n=this.slug;this.$axios.$post("v1/pin/update/story",{slug:n,notebook:this.notebook,content:[{type:"title",data:this.title}].concat(this.content),publish:t}).then((function(n){e.removeCache(),t?window.location=e.$alias.pin(n):e.loading=!1})).catch((function(t){e.$toast.error(t.message),e.loading=!1}))}},actionRedo:function(){(this.content.length||this.title.text.length||this.title.banner)&&(this.removeCache(),this.$toast.success(this.slug?"撤销成功":"删除成功").then((function(){window.location.reload()})))},removeCache:function(){this.$cache.del("editor_local_draft_title-".concat(this.slug)),this.$cache.del("editor_local_draft-".concat(this.slug))}},head:function(){return{title:"创作中心"}}},A=(n(510),Object(T.a)(H,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"wander"}},[n("div",{staticClass:"wrap"},[n("div",{staticClass:"banner"},[n("ElUpload",{staticClass:"uploader",attrs:{drag:"",action:t.imageUploadAction,accept:t.imageUploadAccept,data:t.uploadHeaders,"before-upload":t.handleImageUploadBefore,"on-success":t.customImageUploadSuccess,"on-error":t.handleImageUploadError}},[n("div",{staticClass:"el-upload-tip",attrs:{slot:"tip"},slot:"tip"},[n("i",{staticClass:"el-icon-picture"}),t._v(" "),n("div",[t._v("请添加封面图（选填）")]),t._v(" "),n("p",[t._v("支持8MB内的JPG／JPEG／PNG格式的高清图片"),n("br"),t._v("（建议大于960*540像素）")])])]),t._v(" "),t.title&&t.title.banner?[n("div",{staticClass:"image",style:{backgroundImage:"url("+t.$resizeImage(t.title.banner.url,{width:660})}}),t._v(" "),n("div",{staticClass:"tool"},[n("i",{staticClass:"el-icon-delete",on:{click:t.deleteBanner}})])]:t._e()],2),t._v(" "),n("div",{staticClass:"title"},[n("ElInput",{attrs:{"show-word-limit":!0,autosize:{minRows:1,maxRows:2},type:"textarea",resize:"none",placeholder:"请输入标题（建议30字以内）",maxlength:"40"},model:{value:t.title.text,callback:function(e){t.$set(t.title,"text",e)},expression:"title.text"}})],1),t._v(" "),n("Editor",{attrs:{slug:t.slug,time:t.last_edit_at},on:{save:t.onEditorSave},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}}),t._v(" "),n("ElForm",{staticClass:"footer",attrs:{"label-position":"top","label-width":"80px"}},[n("ElFormItem",{staticClass:"button-wrap"},[t.slug?[n("ElButton",{attrs:{loading:t.loading,type:"success",round:""},on:{click:function(e){return t.actionUpdate(!0)}}},[t._v("\n            "+t._s(t.published_at?"发布更新":"更新并发布")+"\n          ")]),t._v(" "),t.published_at?t._e():n("ElButton",{attrs:{loading:t.loading,round:"",plain:"",type:"warning"},on:{click:function(e){return t.actionUpdate(!1)}}},[t._v("\n            存草稿\n          ")]),t._v(" "),n("ElButton",{attrs:{loading:t.loading,type:"primary",round:"",plain:""},on:{click:t.actionRedo}},[t._v("\n            撤销修改\n          ")])]:[n("ElButton",{attrs:{loading:t.loading,type:"success",round:""},on:{click:function(e){return t.actionCreate(!0)}}},[t._v("\n            发表文章\n          ")]),t._v(" "),n("ElButton",{attrs:{loading:t.loading,round:"",plain:"",type:"warning"},on:{click:function(e){return t.actionCreate(!1)}}},[t._v("\n            存草稿\n          ")]),t._v(" "),n("ElButton",{attrs:{loading:t.loading,type:"primary",round:"",plain:""},on:{click:t.actionRedo}},[t._v("\n            删除文章\n          ")])]],2)],1)],1)])}),[],!1,null,null,null));e.default=A.exports}}]);